<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper SYSTEM "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.bhidi.lincang.dao.FamilyInfoMapper">
    <!--People BasicInfoOfFamily(String name);-->
    <select id="BasicInfoOfFamily" parameterType="String" resultType="com.bhidi.lincang.bean.People">
        SELECT p.* FROM people p INNER JOIN move m ON p.`FID` = m.`FID` WHERE m.FROM_DISTRICT = #{name} AND p.`MASTER` = '1'
    </select>
    <!--List<People> queryFamilyInfoByFid(String fid);-->
    <select id="queryFamilyInfoByFid" parameterType="String" resultType="com.bhidi.lincang.bean.People">
        SELECT name,gender,race,phone FROM people WHERE fid = #{fid}
    </select>
    <!--PeopleMore queryFamilyDetailByFid(String fid);-->
    <select id="queryFamilyDetailByFid" parameterType="String" resultType="com.bhidi.lincang.bean.PeopleMore">
        SELECT p.name,p.pid,p.RESERVOIR,p.home_size,p.imm_num,p.prop,p.poor_reason,GROUP_CONCAT(m.FROM_CITY,m.FROM_DISTRICT,m.FROM_TOWN,m.FROM_VILLAGE)AS outarea,
        GROUP_CONCAT(m.TO_CITY,m.TO_DISTRICT,m.TO_TOWN,m.TO_VILLAGE)AS inarea,
        GROUP_CONCAT(h.MAIN_STRUCTURE1,h.MAIN_STRUCTURE2,h.MAIN_STRUCTURE3,h.MAIN_STRUCTURE4,h.MAIN_STRUCTURE5) AS mainstructure,
        h.main_size AS mainsize,
        GROUP_CONCAT(h.SUB_STRUCTURE1,h.SUB_STRUCTURE2,h.SUB_STRUCTURE3,h.SUB_STRUCTURE4,h.SUB_STRUCTURE5) AS substructure,
        h.sub_size AS subsize,b.bank_name,b.account_number,
        GROUP_CONCAT(DISTINCT(i.INCOME_SOURCE)) AS income_source,
        SUM(i.INCOME_SUM) AS income_sum
        FROM people p,move m,house h,bank b,income i WHERE p.master = 1 AND p.fid = m.fid AND p.fid = h.fid AND p.fid = b.fid AND p.fid = i.fid
        AND p.fid = #{fid}
    </select>

</mapper>
